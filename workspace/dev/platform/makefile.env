# dev platform

# Include Phase 2 feature flags
-include $(WORKSPACE)/dev/platform/phase2_flags.mk

# Use SDL2
SDL = SDL2

# Native compilation (CROSS_COMPILE should be set to " " in environment)
# Do NOT set CROSS_COMPILE here - it must be set before makefile.env is included
ARCH = -O2
LIBS =

# msettings library location (stub library, functions in platform.c)
PREFIX = /tmp/dev_prefix
LIBS += -L$(PREFIX)/lib

# SDL2 flags
SDL2_CFLAGS = $(shell pkg-config --cflags sdl2 SDL2_image SDL2_ttf)
SDL2_LIBS = $(shell pkg-config --libs sdl2 SDL2_image SDL2_ttf)

# Add SDL2 to flags
CFLAGS += $(SDL2_CFLAGS) -DUSE_SDL2
LIBS += $(SDL2_LIBS)

# Phase 2 feature flags (conditional compilation)
ifeq ($(USE_CONFIG_SYSTEM),1)
    CFLAGS += -DUSE_CONFIG_SYSTEM
endif

ifeq ($(USE_GFX_BACKEND),1)
    CFLAGS += -DUSE_GFX_BACKEND
endif

ifeq ($(USE_FBDEV_BACKEND),1)
    CFLAGS += -DUSE_FBDEV_BACKEND
endif

ifeq ($(USE_FRAME_QUEUE),1)
    CFLAGS += -DUSE_FRAME_QUEUE
    LIBS += -lpthread
endif

ifeq ($(DEBUG_PHASE2),1)
    CFLAGS += -DDEBUG_PHASE2 -DDEBUG
endif

# Additional development flags
CFLAGS += -g -Wall -Wextra
